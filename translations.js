// Translations for Cooking School Booking System
const translations = {
    ru: {
        // Header
        header_title: "Кулинарная школа",
        header_subtitle: "Научитесь готовить как профессионал",

        // Navigation
        nav_classes: "Занятия",
        nav_bookings: "Мои бронирования",
        nav_admin: "Админ-панель",

        // Classes section
        classes_title: "Доступные мастер-классы",
        classes_loading: "Загрузка классов...",
        classes_error: "Не удалось загрузить классы",
        classes_none: "Нет доступных классов",

        // Class card
        class_instructor: "Преподаватель",
        class_duration: "Длительность",
        class_price: "Цена",
        class_capacity: "Мест",
        class_available: "Доступно",
        class_full: "Заполнено",
        class_book: "Забронировать",

        // Booking modal
        booking_title: "Бронирование занятия",
        booking_class: "Занятие",
        booking_date: "Дата",
        booking_time: "Время",
        booking_price: "Цена",
        booking_name: "Ваше имя",
        booking_email: "Email",
        booking_phone: "Телефон",
        booking_participants: "Количество участников",
        booking_allergies: "Аллергии и особые пожелания",
        booking_allergies_placeholder: "Укажите аллергии на продукты или особые пожелания...",
        booking_total: "Итого к оплате",
        booking_card_label: "Данные карты для предоплаты",
        booking_card_info: "Требуется 100% предоплата",
        booking_btn_pay: "Оплатить и забронировать",
        booking_btn_cancel: "Отмена",
        booking_processing: "Обработка платежа...",

        // Payment types
        payment_type_label: "Тип оплаты",
        payment_full: "Полная оплата (100%)",
        payment_full_desc: "Оплатите полную стоимость сейчас",
        payment_partial: "Частичная оплата (10%)",
        payment_partial_desc: "Резервация места - оплатите 10% сейчас",
        payment_deposit: "К оплате сейчас",
        payment_remaining: "Остаток к оплате",
        payment_total_cost: "Общая стоимость",

        // My bookings modal
        mybookings_title: "Мои бронирования",
        mybookings_enter_email: "Введите ваш email для просмотра бронирований",
        mybookings_load: "Загрузить",
        mybookings_loading: "Загрузка...",
        mybookings_none: "У вас пока нет бронирований",
        mybookings_confirmed: "Подтверждено",
        mybookings_cancelled: "Отменено",
        mybookings_cancel: "Отменить бронирование",
        mybookings_cancel_confirm: "Вы уверены, что хотите отменить это бронирование? Средства будут возвращены.",

        // Messages
        msg_success: "Успешно!",
        msg_error: "Ошибка",
        msg_booking_success: "Бронирование подтверждено! Проверьте вашу почту.",
        msg_booking_cancelled: "Бронирование отменено. Средства возвращены.",
        msg_payment_failed: "Оплата не прошла",
        msg_invalid_email: "Введите корректный email",
        msg_fill_fields: "Пожалуйста, заполните все поля",
        msg_card_incomplete: "Пожалуйста, заполните данные карты",

        // Test cards
        test_cards_title: "Тестовые карты для оплаты",
        test_cards_success: "Успешная оплата",
        test_cards_decline: "Отклонённая оплата",
        test_cards_note: "Используйте любую будущую дату и любой CVC",

        // Footer
        footer_rights: "Все права защищены",
        footer_made_with: "Сделано с",

        // Date format
        date_format: "ru-RU"
    },

    lv: {
        // Header
        header_title: "Kulinārijas skola",
        header_subtitle: "Iemācieties gatavot kā profesionālis",

        // Navigation
        nav_classes: "Nodarbības",
        nav_bookings: "Manas rezervācijas",
        nav_admin: "Admina panelis",

        // Classes section
        classes_title: "Pieejamās meistarklases",
        classes_loading: "Ielādē nodarbības...",
        classes_error: "Neizdevās ielādēt nodarbības",
        classes_none: "Nav pieejamu nodarbību",

        // Class card
        class_instructor: "Pasniedzējs",
        class_duration: "Ilgums",
        class_price: "Cena",
        class_capacity: "Vietu",
        class_available: "Pieejamas",
        class_full: "Aizpildīts",
        class_book: "Rezervēt",

        // Booking modal
        booking_title: "Nodarbības rezervācija",
        booking_class: "Nodarbība",
        booking_date: "Datums",
        booking_time: "Laiks",
        booking_price: "Cena",
        booking_name: "Jūsu vārds",
        booking_email: "E-pasts",
        booking_phone: "Tālrunis",
        booking_participants: "Dalībnieku skaits",
        booking_allergies: "Alerģijas un īpašas vēlmes",
        booking_allergies_placeholder: "Norādiet alerģijas pret produktiem vai īpašas vēlmes...",
        booking_total: "Kopā jāmaksā",
        booking_card_label: "Kartes dati avansmaksai",
        booking_card_info: "Nepieciešama 100% avansmaksa",
        booking_btn_pay: "Maksāt un rezervēt",
        booking_btn_cancel: "Atcelt",
        booking_processing: "Apstrādā maksājumu...",

        // Payment types
        payment_type_label: "Maksājuma veids",
        payment_full: "Pilna apmaksa (100%)",
        payment_full_desc: "Samaksājiet pilnu summu tagad",
        payment_partial: "Daļēja apmaksa (10%)",
        payment_partial_desc: "Vietas rezervācija - samaksājiet 10% tagad",
        payment_deposit: "Jāmaksā tagad",
        payment_remaining: "Atlikušā summa",
        payment_total_cost: "Kopējās izmaksas",

        // My bookings modal
        mybookings_title: "Manas rezervācijas",
        mybookings_enter_email: "Ievadiet savu e-pastu, lai skatītu rezervācijas",
        mybookings_load: "Ielādēt",
        mybookings_loading: "Ielādē...",
        mybookings_none: "Jums vēl nav rezervāciju",
        mybookings_confirmed: "Apstiprināts",
        mybookings_cancelled: "Atcelts",
        mybookings_cancel: "Atcelt rezervāciju",
        mybookings_cancel_confirm: "Vai tiešām vēlaties atcelt šo rezervāciju? Nauda tiks atgriezta.",

        // Messages
        msg_success: "Veiksmīgi!",
        msg_error: "Kļūda",
        msg_booking_success: "Rezervācija apstiprināta! Pārbaudiet savu e-pastu.",
        msg_booking_cancelled: "Rezervācija atcelta. Nauda atgriezta.",
        msg_payment_failed: "Maksājums neizdevās",
        msg_invalid_email: "Ievadiet derīgu e-pastu",
        msg_fill_fields: "Lūdzu, aizpildiet visus laukus",
        msg_card_incomplete: "Lūdzu, aizpildiet kartes datus",

        // Test cards
        test_cards_title: "Testa kartes maksājumam",
        test_cards_success: "Veiksmīgs maksājums",
        test_cards_decline: "Noraidīts maksājums",
        test_cards_note: "Izmantojiet jebkuru nākotnes datumu un jebkuru CVC",

        // Footer
        footer_rights: "Visas tiesības aizsargātas",
        footer_made_with: "Izveidots ar",

        // Date format
        date_format: "lv-LV"
    }
};

// Get current language from localStorage or default to Russian
function getCurrentLanguage() {
    return localStorage.getItem('language') || 'ru';
}

// Set current language
function setLanguage(lang) {
    localStorage.setItem('language', lang);
    updatePageLanguage(lang);
}

// Update all text on the page
function updatePageLanguage(lang) {
    const t = translations[lang];
    window.currentLang = lang; // Make it globally accessible

    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (t[key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = t[key];
            } else {
                // Preserve emojis and icons
                const emoji = element.textContent.match(/^[\u{1F300}-\u{1F9FF}][\s]*/u);
                element.textContent = (emoji ? emoji[0] : '') + t[key];
            }
        }
    });

    // Update active language button
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    const activeBtn = document.querySelector(`[data-lang="${lang}"]`);
    if (activeBtn) {
        activeBtn.classList.add('active');
    }

    // Trigger custom event for dynamic content update
    document.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang, t } }));
}

// Helper function to get translation
function t(key, lang = null) {
    const currentLang = lang || window.currentLang || getCurrentLanguage();
    return translations[currentLang][key] || key;
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    const currentLang = getCurrentLanguage();
    updatePageLanguage(currentLang);
});
